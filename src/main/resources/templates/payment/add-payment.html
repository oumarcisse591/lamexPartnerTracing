<!DOCTYPE html>
<html
        xmlns:th="http://www.thymeleaf.org"
        xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
        lang="en"
>
<head>
  <meta charset="UTF-8">
  <title>Faire un paiement</title>

  <!-- Favicons -->
  <link href="assets/img/favicon.png" rel="icon">
  <link href="assets/img/apple-touch-icon.png" rel="apple-touch-icon">

  <!-- Google Fonts -->
  <link href="https://fonts.gstatic.com" rel="preconnect">
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i|Nunito:300,300i,400,400i,600,600i,700,700i|Poppins:300,300i,400,400i,500,500i,600,600i,700,700i" rel="stylesheet">

  <!-- Vendor CSS Files -->
  <link href="assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <link href="assets/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">
  <link href="assets/vendor/boxicons/css/boxicons.min.css" rel="stylesheet">
  <link href="assets/vendor/quill/quill.snow.css" rel="stylesheet">
  <link href="assets/vendor/quill/quill.bubble.css" rel="stylesheet">
  <link href="assets/vendor/remixicon/remixicon.css" rel="stylesheet">
  <link href="assets/vendor/simple-datatables/style.css" rel="stylesheet">

  <!-- Template Main CSS File -->
  <link href="assets/css/style.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/signature_pad@2.3.2/dist/signature_pad.min.js"></script>
  <style>
    #signature-pad {
        border: 1px solid black;
        width: 19em;
        height: 150px;
    }
  </style>
</head>
<body>
  <div th:insert="~{/layouts/header :: header}"></div>
  <main id="main" class="main">
    <div class="pagetitle">
      <h1>Paiement</h1>
      <nav>
        <ol class="breadcrumb">
          <li class="breadcrumb-item">
            <a href="index.html">Home</a>
          </li>
          <li class="breadcrumb-item">Paiement</li>
        </ol>
      </nav>
    </div><!-- End Page Title -->
    <form
            action="#"
            th:action="@{/save-payment}"
            th:object="${payment}"
            method="POST"
            enctype="multipart/form-data"
    >
      <section class="section">
        <div class="row">
          <div class="col-lg-12">
            <div class="card">
              <div class="card-body">
                <!-- Message en cas d'erreur -->
                <div th:if="${error}">
                  <div
                          class="alert alert-danger alert-dismissible fade show"
                          th:text="${error}"
                          role="alert">
                    <button
                            type="button"
                            class="btn-close"
                            data-bs-dismiss="alert"
                            aria-label="Close"
                    >
                    </button>
                  </div>
                </div>
                <!-- Fin Message en cas d'erreur -->
                <h5 class="card-title">Stock :</h5>
                <select
                        th:field="*{stock.id}"
                        id="inputState"
                        class="form-select"
                >
                  <div th:each="tempStock, iterStat : ${stocks}">
                    <div th:if="${tempStock.partner.enabled}">
                      <option th:text="${tempStock.stockName} + ' - ' + ${#numbers.formatDecimal(stockBalances[tempStock.id], 0, 'COMMA', 2, 'POINT')}"
                              th:value="${tempStock.id}"
                              th:selected="${iterStat.index == 0}"
                      >
                      </option>
                    </div>
                  </div>
                </select>
              </div>
            </div>
          </div>
          <div class="col-lg-12">
            <div class="card">
              <div class="card-body">
                <h5 class="card-title">Le Client :</h5>
                <label
                        for="validationDefault01"
                        class="form-label"
                >
                  Nom complet du client :
                </label>
                <input
                        type="text"
                        th:field="*{clientName}"
                        name="client_name"
                        class="form-control"
                        id="validationDefault01"
                       required
                >
                <label
                        for="validationDefault01"
                        class="form-label"
                >
                  Adresse du client et ou Numero de telephone :
                </label>
                <input
                        type="text"
                        th:field="*{clientAddress}"
                        name="client_address"
                        class="form-control"
                        id="validationDefault02"
                       >
                <label
                        for="validationDefault01"
                        class="form-label"
                >
                  CNI / Passeport No :
                </label>
                <input
                        type="text"
                        th:field="*{clientIdCard}"
                        name="client_id_card"
                        class="form-control"
                        id="validationDefault03"
                >
                <label
                        for="validationDefault01"
                        class="form-label"
                >
                  Televersez la photo de la CNI ou du passeport:
                </label>
                <input
                        type="file"
                        name="image"
                        accept="image/*"
                        class="form-control"
                        id="validationDefault04"
                >
              </div>
            </div>
          </div>
          <div class="col-lg-12">
            <div class="card">
              <div class="card-body">
                <h5 class="card-title">DÃ©tails de la transaction</h5>
                <label
                        for="validationDefault01"
                        class="form-label"
                >
                  En quelle devise souhaitez vous faire le paiement?
                </label>
                <select
                        th:field="*{currencyPayment}"
                        class="form-select"
                        aria-label="Default select example"
                        id="currencySelect"
                        onchange="convertCurrency()"
                >
                  <option
                          th:field="*{currencyPayment}"
                          th:value="USD"
                          value="USD"
                  >
                    USD
                  </option>
                  <option
                          th:field="*{currencyPayment}"
                          th:value="AED"
                          value="AED"
                  >
                    AED
                  </option>
                </select>
                <label
                        for="validationDefault01"
                        class="form-label"
                >
                  Montant :
                </label>
                <input
                        type="text"
                        th:field="*{transactionAmount}"
                        name="transaction_amount"
                        class="form-control"
                        id="transactionAmount"
                        oninput="convertCurrency()"
                       required
                >
                <!-- Affiche la conversion du dollar en AED en instantanee -->
                <div
                        class="alert alert-success alert-dismissible fade show"
                        th:text="${message}"
                        role="alert"
                        id="result"
                        style="margin-top:5px"
                >
                  <button
                          type="button"
                          class="btn-close"
                          data-bs-dismiss="alert"
                          aria-label="Close"
                  >
                  </button>
                </div>
                <!-- Fin Affiche la conversion du dollar en AED en instantanee -->

                <div class="col-sm-12">
                  <label
                          for="validationDefault01"
                          class="form-label"
                  >
                    Entrez une remarque sur ce paiement
                  </label>
                  <textarea
                          class="form-control"
                          th:field="*{remark}"
                          name="remark"
                          style="height: 100px"
                  >
                  </textarea>
                </div>
                <label
                        for="validationDefault01"
                        class="form-label"
                >
                  Signature du payeur ou du guichetier
                </label>
                <div id="signature-pad">
                  <canvas></canvas>
                </div>
                <div style="margin-top: 5px;">
                  <button
                          class="btn"
                          type="button"
                          id="clear"
                  >
                    Effacer la signature
                  </button>
                  <input
                          type="hidden"
                          name="signature_agent"
                          id="signature"
                  >
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="">
          <button
                  id="save"
                  class="btn btn-primary"
                  type="submit"
          >
            Valider
          </button>
        </div>
      </section>
    </form>

    <script src="assets/vendor/apexcharts/apexcharts.min.js"></script>
    <script src="assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
    <script src="assets/vendor/chart.js/chart.umd.js"></script>
    <script src="assets/vendor/echarts/echarts.min.js"></script>
    <script src="assets/vendor/quill/quill.min.js"></script>
    <script src="assets/vendor/simple-datatables/simple-datatables.js"></script>
    <script src="assets/vendor/tinymce/tinymce.min.js"></script>
    <script src="assets/vendor/php-email-form/validate.js"></script>

    <!-- Template Main JS File -->
    <script src="assets/js/main.js"></script>
    <script src="assets/js/file.js"></script>
  </main>
</body>
</html>